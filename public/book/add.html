<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <title>主页</title>
    
      <!-- Set render engine for 360 browser -->
      <meta name="renderer" content="webkit">
    
      <!-- No Baidu Siteapp-->
      <meta http-equiv="Cache-Control" content="no-siteapp"/>
    
      <link rel="icon" type="image/png" href="../assets/i/favicon.png">
    
      <!-- Add to homescreen for Chrome on Android -->
      <meta name="mobile-web-app-capable" content="yes">
      <link rel="icon" sizes="192x192" href="../assets/i/app-icon72x72@2x.png">
    
      <!-- Add to homescreen for Safari on iOS -->
      <meta name="apple-mobile-web-app-capable" content="yes">
      <meta name="apple-mobile-web-app-status-bar-style" content="black">
      <meta name="apple-mobile-web-app-title" content="Amaze UI"/>
      <link rel="apple-touch-icon-precomposed" href="../assets/i/app-icon72x72@2x.png">
    
      <!-- Tile icon for Win8 (144x144 + tile color) -->
      <meta name="msapplication-TileImage" content="../assets/i/app-icon72x72@2x.png">
      <meta name="msapplication-TileColor" content="#0e90d2">
    
      <link rel="stylesheet" href="../assets/css/amazeui.min.css">
      <link rel="stylesheet" href="../assets/css/app.css">
      <link rel="stylesheet" href="../css/booktype.css">
      <style>
      li{list-style-type:none;}
      .admin-menu {
        position: fixed;
        z-index: 10;
        top: 60px;
        right: 20px;
    }
      </style>
    </head>
    <body>
   
        <header class="am-topbar am-topbar-fixed-top">
            <div class="am-container">
              <h1 class="am-topbar-brand">
                <a href="#">蓝剑图书馆</a>
              </h1>
          
              <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-secondary am-show-sm-only am-collapsed" data-am-collapse="{target: '#collapse-head'}"><span class="am-sr-only">导航切换</span> <span class="am-icon-bars"></span></button>
          
              <div class="am-topbar-collapse am-collapse" id="collapse-head" style="height: 20px;">
                <ul class="am-nav am-nav-pills am-topbar-nav">
                  <li ><a href="../home.html">首页</a></li>
                  <li class="am-active"><a href="#">图书清单</a></li>
                </ul>
                <div class="am-topbar-right">
                  <button class="am-btn am-btn-secondary am-topbar-btn am-btn-sm"><span class="am-icon-pencil"></span> 注册</button>
                </div>
                <div class="am-topbar-right">
                  <button class="am-btn am-btn-primary am-topbar-btn am-btn-sm"><span class="am-icon-user"></span> 登录</button>
                </div>
              </div>
            </div>
          </header>
    <!--在这里编写你的代码-->
    <div class="am-cf admin-main">
       
      <!-- content start -->
      <div class="admin-content">
        <div class="admin-content-body">
          <div class="am-cf am-padding am-padding-bottom-0">
            <div class="am-fl am-cf">
              <strong class="am-text-primary am-text-lg">图书信息</strong> /  <small>Book Info</small>
            </div>
          </div>
          <hr>
          <div class="am-tabs am-margin" data-am-tabs="">
            <ul class="am-tabs-nav am-nav am-nav-tabs">
              <li class="am-active"><a href="#tab1">基本信息</a></li>
              <li class=""><a href="#tab2">详细描述</a></li>
              <li class=""><a href="#tab3">更多选项</a></li>
            </ul>
      
            <div class="am-tabs-bd" style="touch-action: pan-y; user-select: none; -webkit-user-drag: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
              <div class="am-tab-panel am-fade am-active am-in" id="tab1">
                <div class="am-g am-margin-top">
                  <div class="am-u-sm-2 am-u-md-2 am-text-right">所属类别</div>
                  <div class="am-u-sm-10 am-u-md-10">
                    <select data-am-selected="{btnSize: 'sm'}" style="display: none;">
                      <option value="option1">选项一<option>
                      <option value="option2">选项二<option>
                      <option value="option3">选项三<option>
                    </select>
                  </div>
                </div>

                <div class="am-g am-margin-top">
                  <div class="am-u-sm-2 am-u-md-2 am-text-right">
                    封面
                  </div>
                  <div class="am-u-sm-10 am-u-md-4">
                      <img id='bookcover' src="" />
                  </div>
                </div>
  
                <div class="am-g am-margin-top">
                    <div class="am-u-sm-2 am-u-md-2 am-text-right">
                      ISBN
                    </div>
                    <div class="am-u-sm-10 am-u-md-4">
                      <input type="text" class="am-input-sm" id='isbn'>
                    </div>
                    <div class="am-hide-sm-only am-u-md-6">*必填，不可重复</div>
                </div>

                <div class="am-g am-margin-top">
                  <div class="am-u-sm-2 am-u-md-2 am-text-right">
                    书名
                  </div>
                  <div class="am-u-sm-10 am-u-md-4">
                    <input type="text" class="am-input-sm" id='bookname'>
                  </div>
                  <div class="am-hide-sm-only am-u-md-6">*必填，不可重复</div>
                </div>

                <div class="am-g am-margin-top">
                    <div class="am-u-sm-2 am-u-md-2 am-text-right">
                      子标题
                    </div>
                    <div class="am-u-sm-10 am-u-md-4">
                      <input type="text" class="am-input-sm" id="sub_name">
                    </div>
                    <div class="am-hide-sm-only am-u-md-6">*必填，不可重复</div>
                  </div>
    
                <div class="am-g am-margin-top">
                  <div class="am-u-sm-2 am-u-md-2 am-text-right">
                    作者
                  </div>
                  <div class="am-u-sm-10 am-u-md-4 am-u-end col-end">
                    <input type="text" class="am-input-sm" id="author">
                  </div>
                </div>

                <div class="am-g am-margin-top">
                  <div class="am-u-sm-2 am-u-md-2 am-text-right">
                    入库时间
                  </div>
                  <div class="am-u-sm-10 am-u-md-10">
                    <form action="" class="am-form am-form-inline">
                      <div class="am-form-group am-form-icon">
                        <i class="am-icon-calendar"></i>
                        <input type="datetime-local" id="instoragedate" class="am-form-field am-input-sm" placeholder="时间">
                      </div>
                    </form>
                  </div>
                </div>
    
                <!-- <div class="am-g am-margin-top">
                  <div class="am-u-sm-2 am-u-md-2 am-text-right">显示状态</div>
                  <div class="am-u-sm-10 am-u-md-10">
                    <div class="am-btn-group" data-am-button="">
                      <label class="am-btn am-btn-default am-btn-xs">
                        <input type="radio" name="options" id="option1"> 正常
                      </label>
                      <label class="am-btn am-btn-default am-btn-xs">
                        <input type="radio" name="options" id="option2"> 待审核
                      </label>
                      <label class="am-btn am-btn-default am-btn-xs">
                        <input type="radio" name="options" id="option3"> 不显示
                      </label>
                    </div>
                  </div>
                </div>
      
                <div class="am-g am-margin-top">
                  <div class="am-u-sm-2 am-u-md-2 am-text-right">推荐类型</div>
                  <div class="am-u-sm-10 am-u-md-10">
                    <div class="am-btn-group" data-am-button="">
                      <label class="am-btn am-btn-default am-btn-xs">
                        <input type="checkbox"> 允许评论
                      </label>
                      <label class="am-btn am-btn-default am-btn-xs">
                        <input type="checkbox"> 置顶
                      </label>
                      <label class="am-btn am-btn-default am-btn-xs">
                        <input type="checkbox"> 推荐
                      </label>
                      <label class="am-btn am-btn-default am-btn-xs">
                        <input type="checkbox"> 热门
                      </label>
                      <label class="am-btn am-btn-default am-btn-xs">
                        <input type="checkbox"> 轮播图
                      </label>
                    </div>
                  </div>
                </div> -->
              </div>
      
              <div class="am-tab-panel am-fade" id="tab2">
                <form class="am-form">
                  <div class="am-g am-margin-top">
                    <div class="am-u-sm-2 am-u-md-2 am-text-right">
                      出版社
                    </div>
                    <div class="am-u-sm-10 am-u-md-4 am-u-end col-end">
                      <input type="text" class="am-input-sm" id="press">
                    </div>
                  </div>

                  <div class="am-g am-margin-top">
                    <div class="am-u-sm-2 am-u-md-2 am-text-right">
                      出版日期
                    </div>
                    <div class="am-u-sm-10 am-u-md-4 am-u-end col-end">
                      <input type="text" class="am-input-sm" id="publicationdate">
                    </div>
                  </div>
                  <div class="am-g am-margin-top">
                    <div class="am-u-sm-2 am-u-md-2 am-text-right">
                      字数
                    </div>
                    <div class="am-u-sm-10 am-u-md-4 am-u-end col-end">
                      <input type="text" class="am-input-sm" id="wordcount">
                    </div>
                  </div>
                  <div class="am-g am-margin-top">
                    <div class="am-u-sm-2 am-u-md-2 am-text-right">
                      页数
                    </div>
                    <div class="am-u-sm-10 am-u-md-4 am-u-end col-end">
                      <input type="text" class="am-input-sm" id="pagecount">
                    </div>
                  </div>
                </form>
              </div>
      
              <div class="am-tab-panel am-fade" id="tab3">
                <form class="am-form">
                  
                  <div class="am-g am-margin-top-sm">
                    <div class="am-u-sm-2 am-u-md-2 am-text-right">
                      图书简介
                    </div>
                    <div class="am-u-sm-10 am-u-md-4 am-u-end">
                      <textarea rows="8" id="contentintroduction"></textarea>
                    </div>
                  </div>

                  <div class="am-g am-margin-top-sm">
                    <div class="am-u-sm-2 am-u-md-2 am-text-right">
                      作者简介
                    </div>
                    <div class="am-u-sm-10 am-u-md-4 am-u-end">
                      <textarea rows="8" id="authorintroduction"></textarea>
                    </div>
                  </div>

                  <div class="am-g am-margin-top-sm">
                    <div class="am-u-sm-2 am-u-md-2 am-text-right">
                      目录
                    </div>
                    <div class="am-u-sm-10 am-u-md-4 am-u-end">
                      <textarea rows="12" id="catelogue"></textarea>
                    </div>
                  </div>
                </form>
              </div>
      
            </div>
          </div>
      
          <div class="am-margin">
            <button type="button" class="am-btn am-btn-primary am-btn-xs">提交保存</button>
            <button type="button" class="am-btn am-btn-primary am-btn-xs">放弃保存</button>
          </div>
        </div>
      
        <footer class="admin-content-footer">
          <hr>
          <p class="am-padding-left">© 2014 AllMobilize, Inc. Licensed under MIT license.</p>
        </footer>
      </div>
      <!-- content end -->
      
      </div>
      



      <a href="#" id="btnscanQr" class="am-icon-btn am-icon-th-list am-show-sm-only admin-menu" ></a>

    <!--在这里编写你的代码-->
    
    <!--[if (gte IE 9)|!(IE)]><!-->
    <script src="../assets/js/jquery.min.js"></script>
    <!--<![endif]-->
    <!--[if lte IE 8 ]>
    <script src="http://libs.baidu.com/jquery/1.11.3/jquery.min.js"></script>
    <script src="http://cdn.staticfile.org/modernizr/2.8.3/modernizr.js"></script>
    <script src="assets/js/amazeui.ie8polyfill.min.js"></script>
    <![endif]-->
    <script src="../assets/js/amazeui.min.js"></script>
    <script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
    <script src="https://cdn.bootcss.com/js-sha1/0.4.1/sha1.js"></script>
    <script>
      $.ajax({
        type: "GET",
        url: "https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=wxa4e7517fe99f820e&secret=513a774504039197f29fcf486ddb32c5",
        data: {},
        dataType: 'jsonp',
        crossDomain: true,
        success: function(result){
          var access_token = result.access_token;
          alert('accesstoken:'+access_token);
          $.ajax({
            type: "GET",
            url: "https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token="+access_token+"&type=jsapi",
            data: {},
            dataType: 'jsonp',
            crossDomain: true,
            success: function(res){
             var ticket = res.ticket;
             var str='jsapi_ticket='+ticket+'&noncestr=Wm3WZYTPz0wzccnW&timestamp=1503495323&url='+location.href;
             var signature=sha1(str);

             wx.config({
              debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
              appId: 'wxa4e7517fe99f820e', // 必填，公众号的唯一标识
              timestamp: 1503495323 , // 必填，生成签名的时间戳
              nonceStr: 'Wm3WZYTPz0wzccnW', // 必填，生成签名的随机串
              signature: signature,// 必填，签名，见附录1
              jsApiList: ['scanQRCode'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
            });
            wx.ready(function(){
                // config信息验证后会执行ready方法，所有接口调用都必须在config接口获得结果之后，config是一个客户端的异步操作，所以如果需要在页面加载时就调用相关接口，则须把相关接口放在ready函数中调用来确保正确执行。对于用户触发时才调用的接口，则可以直接调用，不需要放在ready函数中。
                //alert('ok');

                wx.checkJsApi({
                  jsApiList: ['scanQRCode'], // 需要检测的JS接口列表，所有JS接口列表见附录2,
                  success: function(res) {
                      // 以键值对的形式返回，可用的api值true，不可用为false
                      // 如：{"checkResult":{"chooseImage":true},"errMsg":"checkJsApi:ok"}
                      //alert(res);
                  },
                  error:function(res){
                    //alert(res);
                  }
                });
            });
            wx.error(function(res){
              // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。
              //alert(res);
            });

            }
          });
        }
      });
      
    </script>
    <script>
      
    </script>
    <script>
      $('#btnscanQr').click(function(){
        wx.scanQRCode({
          needResult: 1, // 默认为0，扫描结果由微信处理，1则直接返回扫描结果，
          scanType: ["qrCode","barCode"], // 可以指定扫二维码还是一维码，默认二者都有
          success: function (res) {
              var result = res.resultStr; // 当needResult 为 1 时，扫码返回的结果
              // alert(result);
              // var result='EAN_13,9787115346421';
              $.ajax({
                type: "GET",
                url: "https://api.douban.com/v2/book/isbn/"+result.split(',')[1],
                data: {},
                dataType: 'jsonp',
                crossDomain: true,
                success: function(bio){
                  $('#bookcover').attr('src',bio.image);
                  $('#isbn').val(bio.isbn13);
                  $('#bookname').val(bio.title);
                  $('#sub_name').val(bio.subtitle);
                  $('#author').val(bio.author);

                  $('#press').val(bio.publisher);
                  $('#publicationdate').val(bio.pubdate);
                  $('#wordcount').val(0);
                  $('#pagecount').val(bio.pages);

                  $('#contentintroduction').val(bio.summary);
                  $('#authorintroduction').val(bio.author_intro);
                  $('#catelogue').val(bio.catalog);
                }
            });
          }
        });
      });      
    </script>
    </body>
    </html>